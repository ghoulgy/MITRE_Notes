# SharpView

Usually it is use together with Cobalt Strike `execute-assembly` module so that it runs in memory only without touching disk.

## Command List and Its LDAP Filter

The LDAP filters in the table were generated by executing the command with no extra parameter.

| SharpView Command | LDAP Filter |
|---|---|
| Get-DomainGPOUserLocalGroupMapping | (&(objectCategory=groupPolicyContainer)) |
| Find-GPOLocation | (&(objectCategory=groupPolicyContainer)) |
| Get-DomainGPOComputerLocalGroupMapping |
| Find-GPOComputerAdmin |
| Get-DomainObjectAcl | (objectClass=\*) |
| Get-ObjectAcl | (objectClass=\*) |
| Add-DomainObjectAcl | (objectClass=\*)<br>(objectClass=\*) |
| Add-ObjectAcl | (objectClass=\*)<br>(objectClass=\*) |
| Remove-DomainObjectAcl | (objectClass=\*)<br>(objectClass=\*) |
| Get-RegLoggedOn |
| Get-LoggedOnLocal |
| Get-NetRDPSession |
| Test-AdminAccess |
| Invoke-CheckLocalAdminAccess |
| Get-WMIProcess |
| Get-NetProcess |
| Get-WMIRegProxy |
| Get-Proxy |
| Get-WMIRegLastLoggedOn |
| Get-LastLoggedOn |
| Get-WMIRegCachedRDPConnection |
| Get-CachedRDPConnection |
| Get-WMIRegMountedDrive |
| Get-RegistryMountedDrive |
| Find-InterestingDomainAcl | (objectClass=\*)<br>Bunch of (&(\|(distinguishedname=CN=YOUR_DOMAIN_USER,CN=Users,DC=lord,DC=me))) |
| Get-NetShare |
| Get-NetLoggedon |
| Get-NetLocalGroup |
| Get-NetLocalGroupMember |
| Get-NetSession |
| Get-PathAcl |
| ConvertFrom-UACValue |
| Get-PrincipalContext |
| New-DomainGroup |
| New-DomainUser |
| Add-DomainGroupMember |
| Set-DomainUserPassword |
| Invoke-Kerberoast | (&(samAccountType=805306368)(servicePrincipalName=\*)) |
| Export-PowerViewCSV |
| Find-LocalAdminAccess | (&(samAccountType=805306369)) |
| Find-DomainLocalGroupMember | (&(samAccountType=805306369)) |
| Find-DomainShare | (&(samAccountType=805306369)) |
| Find-DomainUserEvent | (&(objectCategory=group)(\|(samAccountName=Domain Admins)))<br>(&(\|(distinguishedname=CN=IT Admins,CN=Users,DC=lord,DC=me)))<br>(&(objectCategory=group)(\|(distinguishedname=CN=IT Admins,CN=Users,DC=lord,DC=me)))<br>(&(\|(distinguishedname=CN=Administrator,CN=Users,DC=lord,DC=me)))<br>(&(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=8192)) |
| Find-DomainProcess | (&(samAccountType=805306369))<br>(&(objectCategory=group)(\|(samAccountName=Domain Admins)))<br>(&(\|(distinguishedname=CN=IT Admins,CN=Users,DC=lord,DC=me)))<br>(&(objectCategory=group)(\|(distinguishedname=CN=IT Admins,CN=Users,DC=lord,DC=me)))<br>(&(\|(distinguishedname=CN=Administrator,CN=Users,DC=lord,DC=me))) |
| Find-DomainUserLocation | (&(samAccountType=805306369))<br>(&(objectCategory=group)(\|(samAccountName=Domain Admins)))<br>(&(\|(distinguishedname=CN=IT Admins,CN=Users,DC=lord,DC=me)))<br>(&(objectCategory=group)(\|(distinguishedname=CN=IT Admins,CN=Users,DC=lord,DC=me)))<br>(&(\|(distinguishedname=CN=Administrator,CN=Users,DC=lord,DC=me))) |
| Find-InterestingFile |
| Find-InterestingDomainShareFile | (&(samAccountType=805306369)) |
| Find-DomainObjectPropertyOutlier | (&(samAccountType=805306368)) |
| TestMethod |
| Get-Domain |
| Get-NetDomain |
| Get-DomainComputer | (&(samAccountType=805306369)) |
| Get-NetComputer | (&(samAccountType=805306369)) |
| Get-DomainController |
| Get-NetDomainController |
| Get-DomainFileServer |
| Get-NetFileServer |
| Convert-ADName |
| Get-DomainObject | (objectClass=\*) |
| Get-ADObject | (objectClass=\*) |
| Get-DomainUser | (&(samAccountType=805306368)) |
| Get-NetUser | (&(samAccountType=805306368)) |
| Get-DomainGroup | (&(objectCategory=group)) |
| Get-NetGroup | (&(objectCategory=group)) |
| Get-DomainDFSShare |
| Get-DFSshare |
| Get-DomainDNSRecord |
| Get-DNSRecord |
| Get-DomainDNSZone |
| Get-DNSZone |
| Get-DomainForeignGroupMember | (&(objectCategory=group)(member=\*)) |
| Find-ForeignGroup | (&(objectCategory=group)(member=\*)) |
| Get-DomainForeignUser | (&(samAccountType=805306368)(memberof=\*)) |
| Find-ForeignUser | (&(samAccountType=805306368)(memberof=\*)) |
| ConvertFrom-SID |
| Convert-SidToName |
| Get-DomainGroupMember | (&(objectCategory=group))<br>(&(\|(distinguishedname=CN=Domain Admins,CN=Users,DC=lord,DC=me)))<br>(&(\|(distinguishedname=CN=Enterprise Admins,CN=Users,DC=lord,DC=me)))<br>(&(\|(distinguishedname=CN=Administrator,CN=Users,DC=lord,DC=me))) |
| Get-NetGroupMember | (&(objectCategory=group))<br>(&(\|(distinguishedname=CN=Domain Admins,CN=Users,DC=lord,DC=me)))<br>(&(\|(distinguishedname=CN=Enterprise Admins,CN=Users,DC=lord,DC=me)))<br>(&(\|(distinguishedname=CN=Administrator,CN=Users,DC=lord,DC=me))) |
| Get-DomainManagedSecurityGroup | (&(objectCategory=group)(&(managedBy=\*)(groupType:1.2.840.113556.1.4.803:=2147483648))) |
| Find-ManagedSecurityGroups | (&(objectCategory=group)(&(managedBy=\*)(groupType:1.2.840.113556.1.4.803:=2147483648))) |
| Get-DomainOU | (&(objectCategory=organizationalUnit)) |
| Get-NetOU | (&(objectCategory=organizationalUnit)) |
| Get-DomainSID | (&(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=8192)) |
| Get-Forest | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Get-NetForest | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Get-ForestTrust | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Get-NetForestTrust |
| Get-DomainTrust | (&(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=8192)) |
| Get-NetDomainTrust | (&(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=8192)) |
| Get-ForestDomain | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Get-NetForestDomain | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Get-DomainSite | (&(objectCategory=site)) |
| Get-NetSite | (&(objectCategory=site)) |
| Get-DomainSubnet | (&(objectCategory=site)) |
| Get-NetSubnet | (&(objectCategory=site)) |
| Get-DomainTrustMapping | (&(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=8192)) |
| Invoke-MapDomainTrust | (&(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=8192)) |
| Get-ForestGlobalCatalog | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Get-NetForestCatalog | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Get-DomainUserEvent |
| Get-UserEvent |
| Get-DomainGUIDMap | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Get-GUIDMap | (&(samAccountType=805306368)(\|(samAccountName=krbtgt))) |
| Resolve-IPAddress |
| Get-IPAddress |
| ConvertTo-SID |
| Invoke-UserImpersonation |
| Invoke-RevertToSelf |
| Get-DomainSPNTicket |
| Request-SPNTicket |
| Get-NetComputerSiteName |
| Get-SiteName |
| Get-DomainGPO | (&(objectCategory=groupPolicyContainer)) |
| Get-NetGPO | (&(objectCategory=groupPolicyContainer)) |
| Set-DomainObject | (objectClass=\*) |
| Set-ADObject | (objectClass=\*) |
| Add-RemoteConnection |
| Remove-RemoteConnection |
| Get-IniContent |
| Get-GptTmpl |
| Get-GroupsXML |
| Get-DomainPolicyData | (&(objectCategory=groupPolicyContainer)(\|(name={31B2F340-016D-11D2-945F-00C04FB984F9}))) |
| Get-DomainPolicy | (&(objectCategory=groupPolicyContainer)(\|(name={31B2F340-016D-11D2-945F-00C04FB984F9}))) |
| Get-DomainGPOLocalGroup | (&(objectCategory=groupPolicyContainer)) |
| Get-NetGPOGroup | (&(objectCategory=groupPolicyContainer)) |

## Source
Tevora-threat's [Github](https://github.com/tevora-threat/SharpView)
